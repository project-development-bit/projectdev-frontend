<!DOCTYPE html>
<title>Authentication complete</title>
<p>Authentication is complete. If this does not happen automatically, please close the window.</p>
<script>
  function postAuthenticationMessage() {
    const message = {
      'flutter-web-auth-2': window.location.href
    };

    // If the authentication was done in a new window, post the message to the opener
    if (window.opener) {
      window.opener.postMessage(message, window.location.origin);
      window.close();
    } else if (window.parent && window.parent !== window) {
      // If done in an iframe, post the message to the parent window
      window.parent.postMessage(message, window.location.origin);
    } else {
      // Fallback to using localStorage if neither opener nor parent exists
      localStorage.setItem('flutter-web-auth-2', window.location.href);
      window.close();
    }
  }

  // Call the function to send the message back to the app
  postAuthenticationMessage();
</script>